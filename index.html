<!DOCTYPE html>
<html>
<head>
<meta lang="en-nz" charset="utf8" />
<link rel="icon" href="favicon.ico" />
<title>Fruit Math Generator</title>
<style>

body {
  text-align: center;
  font-family: "Liberation Sans", sans-serif;
}

button {
  font-size: inherit;
}

datalist {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  writing-mode: horizontal-tb;
  width: 200px;
}

option {
  padding: 0;
}

eq {
  font-family: "Liberation Sans Bold", sans-serif;
  font-size: 20pt;
  font-weight: bold;
  margin: 0;
}

quad {
  margin-left: 2em;
}

slider {
  display: flex;
  justify-content: space-between;
  margin: 0 35%;
  width: 30%;
  padding: 1em 0;
}

slider input {
  width:200px;
  margin:0;
}

.question-page {
  columns: 2;
  break-inside: avoid;
}

.question {
  break-inside: avoid;
  margin: 0;
  padding: 0.1em 0 0.2em 0;
}

.question p {
  margin: 1.2em 0 0.4em 0;
}

.problem {
  text-align: center;
  padding: 0 0 1em 0;
}

#problems {
  break-after: always;
}

#answer-key {
  text-align: center;
}

#answer-key ol {
  text-align: left;
}

@media print {
  .no-print {
    display:none;
  }
}
</style>
<script>

// TODO: Difficulty levels

var fruits = "üçì,üçâ,üçè,üçä,üçê,ü´ê,üçÖ,ü•≠,ü•ù,üçå,üçá,üçã".split(",");

var answer_key = "";

function generate_problem(difficulty){
  // Generates a problem
  var A = Math.floor(10*Math.random()) + 1;
  var B = Math.floor(10*Math.random()) + 1;
  var C = Math.floor(10*Math.random()) + 1;
  switch(difficulty){
    case 3:
    case 4:
      A = Math.floor(21*Math.random()) - 10;
      B = Math.floor(21*Math.random()) - 10;
      C = Math.floor(21*Math.random()) - 10;
      break;
  }
  var out = "";
  for(let i = 0; i < 3; i++){
    var c1 = 7-Math.floor(Math.sqrt(49*Math.random()));
    var c2 = 7-Math.floor(Math.sqrt(49*Math.random()));
    var c3 = 7-Math.floor(Math.sqrt(49*Math.random()));
    switch(difficulty){
      case 0:
        c1 = 1; c2 = 1; c3 = 1;
        break;
      case 1:
        c1 = 1; c2 = 1;
        break;
      case 2:
        c1 = 1;
        break;
    }
    out += "<eq>";
    switch(i){
      case 0:
      c3 = 0;
      if(difficulty == 0){
        c2 = 0;
        out += c1+"√óA";
      } else {
        out += c1+"√óA + "+c2+"√óB";
      }
      break;
      case 1:
      c2 = 0;
      out += c1+"√óA + "+c3+"√óC";
      break;
      case 2:
      c1 = 0;
      out += c2+"√óB + "+c3+"√óC";
      break;
    }
    out += " = "+(c1*A+c2*B+c3*C)+"</eq><br/>"
  }
  out += "<eq>A + B + C = ?</eq>";
  for (let i = fruits.length-1; i > 0; i--) {
    let r = Math.floor(Math.random() * i);
    [fruits[i], fruits[r]] = [fruits[r], fruits[i]];
  }
  out = out.replace(/1√ó/g, "");
  out = out.replace(/A/g, fruits[0]);
  out = out.replace(/B/g, fruits[1]);
  out = out.replace(/C/g, fruits[2]);
  out = out.replace(/-/g, "&minus;");
  let answer = "A = "+A+"<quad/>B = "+B+"<quad/>C = "+C+"<quad/>A + B + C = "+(A+B+C);
  answer = answer.replace(/A/g, fruits[0]);
  answer = answer.replace(/B/g, fruits[1]);
  answer = answer.replace(/C/g, fruits[2]);
  answer = answer.replace(/-/g, "&minus;");
  answer_key += answer;
  return "<div class=\"problem\">"+out+"</div>";
}

function generate_one(){
  answer_key = "<button id=\"show-button\" onclick=\"show_answer()\" >Show answer</button><div id=\"hidden-answer\" style=\"display:none;\"><h1>Answer:</h1><p>";
  document.getElementById("problems").innerHTML = generate_problem(0);
  answer_key += "</p></div>";
  document.getElementById("answer-key").innerHTML = answer_key;
}

function show_answer(){
  document.getElementById("hidden-answer").style.display = "block";
  document.getElementById("show-button").innerHTML = "Hide answer";
  document.getElementById("show-button").onclick = function(){
    document.getElementById("hidden-answer").style.display = "none";
    document.getElementById("show-button").innerHTML = "Show answer";
    document.getElementById("show-button").onclick = show_answer;
  }
}

function generate_worksheet(){
  // Generate 50 problems of increasing difficulty
  var out = "<div class=\"question-page\">";
  answer_key = "<h1>Answer key</h1><ol>";
  for(let i = 0; i < 50; i++){
    answer_key += "<li>";
    out += "<div class=\"question\">";
    out += "<p>#"+(i+1)+"</p>";
    out += generate_problem(Math.floor(i/10));
    out += "</div>";
    if(i % 10 == 9){
      out += "</div><div class=\"question-page\">"
    }
    answer_key += "</li>";
  }
  out += "</div>"
  answer_key += "</ol>";
  document.getElementById("problems").innerHTML = out;
  document.getElementById("answer-key").innerHTML = answer_key;
}

</script>
</head>
<body onload="generate_one()" >
<div class="no-print">
<h1>Fruit Math Generator</h1>
</div>
<div id="problems">
<div class="problem">
<eq>A + B + C = 10</eq>
</div>
</div>
<div class="no-print">
<button onclick="generate_one()">Generate One!</button>
<button onclick="generate_worksheet()">Generate Many!</button>
<p>Press one of the buttons to generate a fruit math problem. <b>Generate One!</b> will make one problem. <b>Generate Many!</b> will create a worksheet of fifty problems, which you can print out with Ctrl+P.</p>
</div>
<div id="answer-key"></div>
<slider class="no-print">
<div><label for="diff">Adjust difficulty for generating one:</label></div>
<div><input id="diff" name="diff" list="diff_values" type="range" min=0 max=4 step=1 />
<datalist id="diff_values">
  <option value="0" label="Easy" />
  <option value="1" />
  <option value="2" label="Medium" />
  <option value="3" />
  <option value="4" label="Hard" />
</datalist>
</div>
</slider>
</body>
</html>
